/*! JointJS v3.0.1 (2019-06-17) - JavaScript diagramming library


This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
*/
this.joint=this.joint||{},this.joint.layout=this.joint.layout||{},function(e,u,p,d){"use strict";var h={exportElement:function(e){return e.size()},exportLink:function(e){var t=e.get("labelSize")||{};return{minLen:e.get("minLen")||1,weight:e.get("weight")||1,labelpos:e.get("labelPosition")||"c",labeloffset:e.get("labelOffset")||0,width:t.width||0,height:t.height||0}},importElement:function(e,t,i){var n=this.getCell(t),r=i.node(t);e.setPosition?e.setPosition(n,r):n.set("position",{x:r.x-r.width/2,y:r.y-r.height/2})},importLink:function(e,t,i){var n=this.getCell(t.name),r=i.edge(t),o=r.points||[];if((e.setVertices||e.setLinkVertices)&&(u.isFunction(e.setVertices)?e.setVertices(n,o):n.set("vertices",o.slice(1,o.length-1))),e.setLabels&&"x"in r&&"y"in r){var a={x:r.x,y:r.y};if(u.isFunction(e.setLabels))e.setLabels(n,a,o);else{var s=d.Polyline(o),l=s.closestPointLength(a),p=s.pointAtLength(l),h=l/s.length();n.label(0,{position:{distance:h,offset:d.Point(a).difference(p).toJSON()}})}}},layout:function(e,t){var i;i=e instanceof p.Graph?e:(new p.Graph).resetCells(e,{dry:!0,sort:!1}),e=null,t=u.defaults(t||{},{resizeClusters:!0,clusterPadding:10,exportElement:this.exportElement,exportLink:this.exportLink});var n=h.toGraphLib(i,{directed:!0,multigraph:!0,compound:!0,setNodeLabel:t.exportElement,setEdgeLabel:t.exportLink,setEdgeName:function(e){return e.id}}),r={},o=t.marginX||0,a=t.marginY||0;if(t.rankDir&&(r.rankdir=t.rankDir),t.align&&(r.align=t.align),t.nodeSep&&(r.nodesep=t.nodeSep),t.edgeSep&&(r.edgesep=t.edgeSep),t.rankSep&&(r.ranksep=t.rankSep),t.ranker&&(r.ranker=t.ranker),o&&(r.marginx=o),a&&(r.marginy=a),n.setGraph(r),dagre.layout(n,{debugTiming:!!t.debugTiming}),i.startBatch("layout"),h.fromGraphLib(n,{importNode:this.importElement.bind(i,t),importEdge:this.importLink.bind(i,t)}),t.resizeClusters){var s=n.nodes().filter(function(e){return 0<n.children(e).length}).map(i.getCell.bind(i)).sort(function(e,t){return t.getAncestors().length-e.getAncestors().length});u.invoke(s,"fitEmbeds",{padding:t.clusterPadding})}i.stopBatch("layout");var l=n.graph();return d.Rect(o,a,Math.abs(l.width-2*o),Math.abs(l.height-2*a))},fromGraphLib:function(t,i){var n=(i=i||{}).importNode||u.noop,r=i.importEdge||u.noop,o=this instanceof p.Graph?this:new p.Graph;return t.nodes().forEach(function(e){n.call(o,e,t,o,i)}),t.edges().forEach(function(e){r.call(o,e,t,o,i)}),o},toGraphLib:function(e,t){t=t||{};for(var i=u.pick(t,"directed","compound","multigraph"),n=new dagre.graphlib.Graph(i),r=t.setNodeLabel||u.noop,o=t.setEdgeLabel||u.noop,a=t.setEdgeName||u.noop,s=e.get("cells"),l=0,p=s.length;l<p;l++){var h=s.at(l);if(h.isLink()){var d=h.get("source"),g=h.get("target");if(!d.id||!g.id)break;n.setEdge(d.id,g.id,o(h),a(h))}else if(n.setNode(h.id,r(h)),n.isCompound()&&h.has("parent")){var c=h.get("parent");s.has(c)&&n.setParent(h.id,c)}}return n}};p.Graph.prototype.toGraphLib=function(e){return h.toGraphLib(this,e)},p.Graph.prototype.fromGraphLib=function(e,t){return h.fromGraphLib.call(this,e,t)},e.DirectedGraph=h}(this.joint.layout.DirectedGraph=this.joint.layout.DirectedGraph||{},joint.util,joint.dia,g);