/*! JointJS v0.9.3 - JavaScript diagramming library  2015-05-05 


This Source Code Form is subject to the terms of the Mozilla Public
License, v. 2.0. If a copy of the MPL was not distributed with this
file, You can obtain one at http://mozilla.org/MPL/2.0/.
 */
if(function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};d.dagre=a("./index")},{"./index":2}],2:[function(a,b,c){c.Digraph=a("graphlib").Digraph,c.Graph=a("graphlib").Graph,c.layout=a("./lib/layout"),c.version=a("./lib/version")},{"./lib/layout":3,"./lib/version":18,graphlib:24}],3:[function(a,b,c){var d=a("./util"),e=a("./rank"),f=a("./order"),g=a("graphlib").CGraph,h=a("graphlib").CDigraph;b.exports=function(){function b(a){var b=new h;a.eachNode(function(a,c){void 0===c&&(c={}),b.addNode(a,{width:c.width,height:c.height}),c.hasOwnProperty("rank")&&(b.node(a).prefRank=c.rank)}),a.parent&&a.nodes().forEach(function(c){b.parent(c,a.parent(c))}),a.eachEdge(function(a,c,d,e){void 0===e&&(e={});var f={e:a,minLen:e.minLen||1,width:e.width||0,height:e.height||0,points:[]};b.addEdge(null,c,d,f)});var c=a.graph()||{};return b.graph({rankDir:c.rankDir||n.rankDir,orderRestarts:c.orderRestarts}),b}function c(a){var c,g=p.rankSep();try{return c=d.time("initLayoutGraph",b)(a),0===c.order()?c:(c.eachEdge(function(a,b,c,d){d.minLen*=2}),p.rankSep(g/2),d.time("rank.run",e.run)(c,n.rankSimplex),d.time("normalize",i)(c),d.time("order",f)(c,n.orderMaxSweeps),d.time("position",o.run)(c),d.time("undoNormalize",j)(c),d.time("fixupEdgePoints",k)(c),d.time("rank.restoreEdges",e.restoreEdges)(c),d.time("createFinalGraph",l)(c,a.isDirected()))}finally{p.rankSep(g)}}function i(a){var b=0;a.eachEdge(function(c,d,e,f){var g=a.node(d).rank,h=a.node(e).rank;if(h>g+1){for(var i=d,j=g+1,k=0;h>j;++j,++k){var l="_D"+ ++b,m={width:f.width,height:f.height,edge:{id:c,source:d,target:e,attrs:f},rank:j,dummy:!0};0===k?m.index=0:j+1===h&&(m.index=1),a.addNode(l,m),a.addEdge(null,i,l,{}),i=l}a.addEdge(null,i,e,{}),a.delEdge(c)}})}function j(a){a.eachNode(function(b,c){if(c.dummy){if("index"in c){var d=c.edge;a.hasEdge(d.id)||a.addEdge(d.id,d.source,d.target,d.attrs);var e=a.edge(d.id).points;e[c.index]={x:c.x,y:c.y,ul:c.ul,ur:c.ur,dl:c.dl,dr:c.dr}}a.delNode(b)}})}function k(a){a.eachEdge(function(a,b,c,d){d.reversed&&d.points.reverse()})}function l(a,b){var c=b?new h:new g;c.graph(a.graph()),a.eachNode(function(a,b){c.addNode(a,b)}),a.eachNode(function(b){c.parent(b,a.parent(b))}),a.eachEdge(function(a,b,d,e){c.addEdge(e.e,b,d,e)});var d=0,e=0;return a.eachNode(function(b,c){a.children(b).length||(d=Math.max(d,c.x+c.width/2),e=Math.max(e,c.y+c.height/2))}),a.eachEdge(function(a,b,c,f){var g=Math.max.apply(Math,f.points.map(function(a){return a.x})),h=Math.max.apply(Math,f.points.map(function(a){return a.y}));d=Math.max(d,g+f.width/2),e=Math.max(e,h+f.height/2)}),c.graph().width=d,c.graph().height=e,c}function m(a){return function(){return arguments.length?(a.apply(null,arguments),p):a()}}var n={debugLevel:0,orderMaxSweeps:f.DEFAULT_MAX_SWEEPS,rankSimplex:!1,rankDir:"TB"},o=a("./position")(),p={};return p.orderIters=d.propertyAccessor(p,n,"orderMaxSweeps"),p.rankSimplex=d.propertyAccessor(p,n,"rankSimplex"),p.nodeSep=m(o.nodeSep),p.edgeSep=m(o.edgeSep),p.universalSep=m(o.universalSep),p.rankSep=m(o.rankSep),p.rankDir=d.propertyAccessor(p,n,"rankDir"),p.debugAlignment=m(o.debugAlignment),p.debugLevel=d.propertyAccessor(p,n,"debugLevel",function(a){d.log.level=a,o.debugLevel(a)}),p.run=d.time("Total layout",c),p._normalize=i,p}},{"./order":4,"./position":9,"./rank":10,"./util":17,graphlib:24}],4:[function(a,b,c){function d(a,b){function c(){a.eachNode(function(a,b){j[a]=b.order})}arguments.length<2&&(b=p);var d=a.graph().orderRestarts||0,e=m(a);e.forEach(function(b){b=b.filterNodes(function(b){return!a.children(b).length})});for(var f,h=0,i=Number.MAX_VALUE,j={},o=0;o<Number(d)+1&&0!==i;++o){f=Number.MAX_VALUE,n(a,d>0),k.log(2,"Order phase start cross count: "+a.graph().orderInitCC);var q,r,s;for(q=0,r=0;4>r&&b>q&&f>0;++q,++r,++h)g(a,e,q),s=l(a),f>s&&(r=0,f=s,i>s&&(c(),i=s)),k.log(3,"Order phase start "+o+" iter "+q+" cross count: "+s)}Object.keys(j).forEach(function(b){a.children&&a.children(b).length||(a.node(b).order=j[b])}),a.graph().orderCC=i,k.log(2,"Order iterations: "+h),k.log(2,"Order phase best cross count: "+a.graph().orderCC)}function e(a,b){var c={};return b.forEach(function(b){c[b]=a.inEdges(b).map(function(b){return a.node(a.source(b)).order})}),c}function f(a,b){var c={};return b.forEach(function(b){c[b]=a.outEdges(b).map(function(b){return a.node(a.target(b)).order})}),c}function g(a,b,c){c%2===0?h(a,b,c):j(a,b,c)}function h(a,b){var c;for(i=1;i<b.length;++i)c=o(b[i],c,e(a,b[i].nodes()))}function j(a,b){var c;for(i=b.length-2;i>=0;--i)o(b[i],c,f(a,b[i].nodes()))}var k=a("./util"),l=a("./order/crossCount"),m=a("./order/initLayerGraphs"),n=a("./order/initOrder"),o=a("./order/sortLayer");b.exports=d;var p=24;d.DEFAULT_MAX_SWEEPS=p},{"./order/crossCount":5,"./order/initLayerGraphs":6,"./order/initOrder":7,"./order/sortLayer":8,"./util":17}],5:[function(a,b,c){function d(a){for(var b=0,c=f.ordering(a),d=1;d<c.length;++d)b+=e(a,c[d-1],c[d]);return b}function e(a,b,c){var d=[];b.forEach(function(b){var c=[];a.outEdges(b).forEach(function(b){c.push(a.node(a.target(b)).order)}),c.sort(function(a,b){return a-b}),d=d.concat(c)});for(var e=1;e<c.length;)e<<=1;var f=2*e-1;e-=1;for(var g=[],h=0;f>h;++h)g[h]=0;var i=0;return d.forEach(function(a){var b=a+e;for(++g[b];b>0;)b%2&&(i+=g[b+1]),b=b-1>>1,++g[b]}),i}var f=a("../util");b.exports=d},{"../util":17}],6:[function(a,b,c){function d(a){function b(d){if(null===d)return void a.children(d).forEach(function(a){b(a)});var e=a.node(d);e.minRank="rank"in e?e.rank:Number.MAX_VALUE,e.maxRank="rank"in e?e.rank:Number.MIN_VALUE;var g=new f;return a.children(d).forEach(function(c){var d=b(c);g=f.union([g,d]),e.minRank=Math.min(e.minRank,a.node(c).minRank),e.maxRank=Math.max(e.maxRank,a.node(c).maxRank)}),"rank"in e&&g.add(e.rank),g.keys().forEach(function(a){a in c||(c[a]=[]),c[a].push(d)}),g}var c=[];b(null);var d=[];return c.forEach(function(b,c){d[c]=a.filterNodes(e(b))}),d}var e=a("graphlib").filter.nodesFromList,f=a("cp-data").Set;b.exports=d},{"cp-data":19,graphlib:24}],7:[function(a,b,c){function d(a,b){var c=[];a.eachNode(function(b,d){var e=c[d.rank];a.children&&a.children(b).length>0||(e||(e=c[d.rank]=[]),e.push(b))}),c.forEach(function(c){b&&f.shuffle(c),c.forEach(function(b,c){a.node(b).order=c})});var d=e(a);a.graph().orderInitCC=d,a.graph().orderCC=Number.MAX_VALUE}var e=a("./crossCount"),f=a("../util");b.exports=d},{"../util":17,"./crossCount":5}],8:[function(a,b,c){function d(a,b,c){var d=[],f={};a.eachNode(function(a,b){d[b.order]=a;var g=c[a];g.length&&(f[a]=e.sum(g)/g.length)});var g=a.nodes().filter(function(a){return void 0!==f[a]});g.sort(function(b,c){return f[b]-f[c]||a.node(b).order-a.node(c).order});for(var h=0,i=0,j=g.length;j>i;++h)void 0!==f[d[h]]&&(a.node(g[i++]).order=h)}var e=a("../util");b.exports=d},{"../util":17}],9:[function(a,b,c){var d=a("./util");b.exports=function(){function a(a){a=a.filterNodes(d.filterNonSubgraphs(a));var b=d.ordering(a),g=c(a,b),h={};["u","d"].forEach(function(c){"d"===c&&b.reverse(),["l","r"].forEach(function(d){"r"===d&&k(b);var i=c+d,l=e(a,b,g,"u"===c?"predecessors":"successors");h[i]=f(a,b,l.pos,l.root,l.align),s.debugLevel>=3&&r(c+d,a,b,h[i]),"r"===d&&j(h[i]),"r"===d&&k(b)}),"d"===c&&b.reverse()}),i(a,b,h),a.eachNode(function(b){var c=[];for(var d in h){var e=h[d][b];p(d,a,b,e),c.push(e)}c.sort(function(a,b){return a-b}),o(a,b,(c[1]+c[2])/2)});var n=0,t="BT"===a.graph().rankDir||"RL"===a.graph().rankDir;b.forEach(function(b){var c=d.max(b.map(function(b){return m(a,b)}));n+=c/2,b.forEach(function(b){q(a,b,t?-n:n)}),n+=c/2+s.rankSep});var u=d.min(a.nodes().map(function(b){return o(a,b)-l(a,b)/2})),v=d.min(a.nodes().map(function(b){return q(a,b)-m(a,b)/2}));a.eachNode(function(b){o(a,b,o(a,b)-u),q(a,b,q(a,b)-v)})}function b(a,b){return b>a?a.toString().length+":"+a+"-"+b:b.toString().length+":"+b+"-"+a}function c(a,c){function d(a){var c=k[a];(g>c||c>i)&&(j[b(f[h],a)]=!0)}var e,f,g,h,i,j={},k={};if(c.length<=2)return j;c[1].forEach(function(a,b){k[a]=b});for(var l=1;l<c.length-1;++l){e=c[l],f=c[l+1],g=0,h=0;for(var m=0;m<f.length;++m){var n=f[m];if(k[n]=m,i=void 0,a.node(n).dummy){var o=a.predecessors(n)[0];void 0!==o&&a.node(o).dummy&&(i=k[o])}if(void 0===i&&m===f.length-1&&(i=e.length-1),void 0!==i){for(;m>=h;++h)a.predecessors(f[h]).forEach(d);g=i}}}return j}function e(a,c,d,e){var f={},g={},h={};return c.forEach(function(a){a.forEach(function(a,b){g[a]=a,h[a]=a,f[a]=b})}),c.forEach(function(c){var i=-1;c.forEach(function(c){var j,k=a[e](c);k.length>0&&(k.sort(function(a,b){return f[a]-f[b]}),j=(k.length-1)/2,k.slice(Math.floor(j),Math.ceil(j)+1).forEach(function(a){h[c]===c&&!d[b(a,c)]&&i<f[a]&&(h[a]=c,h[c]=g[c]=g[a],i=f[a])}))})}),{pos:f,root:g,align:h}}function f(a,b,c,e,f){function g(a,b,c){b in j[a]?j[a][b]=Math.min(j[a][b],c):j[a][b]=c}function h(b){if(!(b in m)){m[b]=0;var d=b;do{if(c[d]>0){var j=e[l[d]];h(j),i[b]===b&&(i[b]=i[j]);var k=n(a,l[d])+n(a,d);i[b]!==i[j]?g(i[j],i[b],m[b]-m[j]-k):m[b]=Math.max(m[b],m[j]+k)}d=f[d]}while(d!==b)}}var i={},j={},k={},l={},m={};return b.forEach(function(a){a.forEach(function(b,c){i[b]=b,j[b]={},c>0&&(l[b]=a[c-1])})}),d.values(e).forEach(function(a){h(a)}),b.forEach(function(a){a.forEach(function(a){if(m[a]=m[e[a]],a===e[a]&&a===i[a]){var b=0;a in j&&Object.keys(j[a]).length>0&&(b=d.min(Object.keys(j[a]).map(function(b){return j[a][b]+(b in k?k[b]:0)}))),k[a]=b}})}),b.forEach(function(a){a.forEach(function(a){m[a]+=k[i[e[a]]]||0})}),m}function g(a,b,c){return d.min(b.map(function(a){var b=a[0];return c[b]}))}function h(a,b,c){return d.max(b.map(function(a){var b=a[a.length-1];return c[b]}))}function i(a,b,c){function d(a){c[l][a]+=j[l]}var e,f={},i={},j={},k=Number.POSITIVE_INFINITY;for(var l in c){var m=c[l];f[l]=g(a,b,m),i[l]=h(a,b,m);var n=i[l]-f[l];k>n&&(k=n,e=l)}["u","d"].forEach(function(a){["l","r"].forEach(function(b){var c=a+b;j[c]="l"===b?f[e]-f[c]:i[e]-i[c]})});for(l in c)a.eachNode(d)}function j(a){for(var b in a)a[b]=-a[b]}function k(a){a.forEach(function(a){a.reverse()})}function l(a,b){switch(a.graph().rankDir){case"LR":return a.node(b).height;case"RL":return a.node(b).height;default:return a.node(b).width}}function m(a,b){switch(a.graph().rankDir){case"LR":return a.node(b).width;case"RL":return a.node(b).width;default:return a.node(b).height}}function n(a,b){if(null!==s.universalSep)return s.universalSep;var c=l(a,b),d=a.node(b).dummy?s.edgeSep:s.nodeSep;return(c+d)/2}function o(a,b,c){if("LR"===a.graph().rankDir||"RL"===a.graph().rankDir){if(arguments.length<3)return a.node(b).y;a.node(b).y=c}else{if(arguments.length<3)return a.node(b).x;a.node(b).x=c}}function p(a,b,c,d){if("LR"===b.graph().rankDir||"RL"===b.graph().rankDir){if(arguments.length<3)return b.node(c)[a];b.node(c)[a]=d}else{if(arguments.length<3)return b.node(c)[a];b.node(c)[a]=d}}function q(a,b,c){if("LR"===a.graph().rankDir||"RL"===a.graph().rankDir){if(arguments.length<3)return a.node(b).x;a.node(b).x=c}else{if(arguments.length<3)return a.node(b).y;a.node(b).y=c}}function r(a,b,c,d){c.forEach(function(c,e){var f,g;c.forEach(function(c){var h=d[c];if(f){var i=n(b,f)+n(b,c);i>h-g&&console.log("Position phase: sep violation. Align: "+a+". Layer: "+e+". U: "+f+" V: "+c+". Actual sep: "+(h-g)+" Expected sep: "+i)}f=c,g=h})})}var s={nodeSep:50,edgeSep:10,universalSep:null,rankSep:30},t={};return t.nodeSep=d.propertyAccessor(t,s,"nodeSep"),t.edgeSep=d.propertyAccessor(t,s,"edgeSep"),t.universalSep=d.propertyAccessor(t,s,"universalSep"),t.rankSep=d.propertyAccessor(t,s,"rankSep"),t.debugLevel=d.propertyAccessor(t,s,"debugLevel"),t.run=a,t}},{"./util":17}],10:[function(a,b,c){function d(a,b){f(a),l.time("constraints.apply",p.apply)(a),g(a),l.time("acyclic",m)(a);var c=a.filterNodes(l.filterNonSubgraphs(a));n(c),r(c).forEach(function(a){var d=c.filterNodes(s.nodesFromList(a));j(d,b)}),l.time("constraints.relax",p.relax(a)),l.time("reorientEdges",i)(a)}function e(a){m.undo(a)}function f(a){a.eachEdge(function(b,c,d,e){if(c===d){var f=h(a,b,c,d,e,0,!1),g=h(a,b,c,d,e,1,!0),i=h(a,b,c,d,e,2,!1);a.addEdge(null,f,c,{minLen:1,selfLoop:!0}),a.addEdge(null,f,g,{minLen:1,selfLoop:!0}),a.addEdge(null,c,i,{minLen:1,selfLoop:!0}),a.addEdge(null,g,i,{minLen:1,selfLoop:!0}),a.delEdge(b)}})}function g(a){a.eachEdge(function(b,c,d,e){if(c===d){var f=e.originalEdge,g=h(a,f.e,f.u,f.v,f.value,0,!0);a.addEdge(null,c,g,{minLen:1}),a.addEdge(null,g,d,{minLen:1}),a.delEdge(b)}})}function h(a,b,c,d,e,f,g){return a.addNode(null,{width:g?e.width:0,height:g?e.height:0,edge:{id:b,source:c,target:d,attrs:e},dummy:!0,index:f})}function i(a){a.eachEdge(function(b,c,d,e){a.node(c).rank>a.node(d).rank&&(a.delEdge(b),e.reversed=!0,a.addEdge(b,d,c,e))})}function j(a,b){var c=o(a);b&&(l.log(1,"Using network simplex for ranking"),q(a,c)),k(a)}function k(a){var b=l.min(a.nodes().map(function(b){return a.node(b).rank}));a.eachNode(function(a,c){c.rank-=b})}var l=a("./util"),m=a("./rank/acyclic"),n=a("./rank/initRank"),o=a("./rank/feasibleTree"),p=a("./rank/constraints"),q=a("./rank/simplex"),r=a("graphlib").alg.components,s=a("graphlib").filter;c.run=d,c.restoreEdges=e},{"./rank/acyclic":11,"./rank/constraints":12,"./rank/feasibleTree":13,"./rank/initRank":14,"./rank/simplex":16,"./util":17,graphlib:24}],11:[function(a,b,c){function d(a){function b(f){f in d||(d[f]=c[f]=!0,a.outEdges(f).forEach(function(d){var g,h=a.target(d);f===h?console.error('Warning: found self loop "'+d+'" for node "'+f+'"'):h in c?(g=a.edge(d),a.delEdge(d),g.reversed=!0,++e,a.addEdge(d,h,f,g)):b(h)}),delete c[f])}var c={},d={},e=0;return a.eachNode(function(a){b(a)}),f.log(2,"Acyclic Phase: reversed "+e+" edge(s)"),e}function e(a){a.eachEdge(function(b,c,d,e){e.reversed&&(delete e.reversed,a.delEdge(b),a.addEdge(b,d,c,e))})}var f=a("../util");b.exports=d,b.exports.undo=e},{"../util":17}],12:[function(a,b,c){function d(a){return"min"!==a&&"max"!==a&&0!==a.indexOf("same_")?(console.error("Unsupported rank type: "+a),!1):!0}function e(a,b,c,d){a.inEdges(b).forEach(function(b){var e,f=a.edge(b);e=f.originalEdge?f:{originalEdge:{e:b,u:a.source(b),v:a.target(b),value:f},minLen:a.edge(b).minLen},f.selfLoop&&(d=!1),d?(a.addEdge(null,c,a.source(b),e),e.reversed=!0):a.addEdge(null,a.source(b),c,e)})}function f(a,b,c,d){a.outEdges(b).forEach(function(b){var e,f=a.edge(b);e=f.originalEdge?f:{originalEdge:{e:b,u:a.source(b),v:a.target(b),value:f},minLen:a.edge(b).minLen},f.selfLoop&&(d=!1),d?(a.addEdge(null,a.target(b),c,e),e.reversed=!0):a.addEdge(null,c,a.target(b),e)})}function g(a,b,c){void 0!==c&&a.children(b).forEach(function(b){b===c||a.outEdges(c,b).length||a.node(b).dummy||a.addEdge(null,c,b,{minLen:0})})}function h(a,b,c){void 0!==c&&a.children(b).forEach(function(b){b===c||a.outEdges(b,c).length||a.node(b).dummy||a.addEdge(null,b,c,{minLen:0})})}c.apply=function(a){function b(c){var i={};a.children(c).forEach(function(g){if(a.children(g).length)return void b(g);var h=a.node(g),j=h.prefRank;if(void 0!==j){if(!d(j))return;j in i?i.prefRank.push(g):i.prefRank=[g];var k=i[j];void 0===k&&(k=i[j]=a.addNode(null,{originalNodes:[]}),a.parent(k,c)),e(a,g,k,"min"===j),f(a,g,k,"max"===j),a.node(k).originalNodes.push({u:g,value:h,parent:c}),a.delNode(g)}}),g(a,c,i.min),h(a,c,i.max)}b(null)},c.relax=function(a){var b=[];a.eachEdge(function(a,c,d,e){var f=e.originalEdge;f&&b.push(f)}),a.eachNode(function(b,c){var d=c.originalNodes;d&&(d.forEach(function(b){b.value.rank=c.rank,a.addNode(b.u,b.value),a.parent(b.u,b.parent)}),a.delNode(b))}),b.forEach(function(b){a.addEdge(b.e,b.u,b.v,b.value)})}},{}],13:[function(a,b,c){function d(a){function b(c){var f=!0;return a.predecessors(c).forEach(function(g){d.has(g)&&!e(a,g,c)&&(d.has(c)&&(h.addNode(c,{}),d.remove(c),h.graph({root:c})),h.addNode(g,{}),h.addEdge(null,g,c,{reversed:!0}),d.remove(g),b(g),f=!1)}),a.successors(c).forEach(function(g){d.has(g)&&!e(a,c,g)&&(d.has(c)&&(h.addNode(c,{}),d.remove(c),h.graph({root:c})),h.addNode(g,{}),h.addEdge(null,c,g,{}),d.remove(g),b(g),f=!1)}),f}function c(){var b=Number.MAX_VALUE;d.keys().forEach(function(c){a.predecessors(c).forEach(function(f){if(!d.has(f)){var g=e(a,f,c);Math.abs(g)<Math.abs(b)&&(b=-g)}}),a.successors(c).forEach(function(f){if(!d.has(f)){var g=e(a,c,f);Math.abs(g)<Math.abs(b)&&(b=g)}})}),h.eachNode(function(c){a.node(c).rank-=b})}var d=new f(a.nodes()),h=new g;if(1===d.size()){var i=a.nodes()[0];return h.addNode(i,{}),h.graph({root:i}),h}for(;d.size();){for(var j=h.order()?h.nodes():d.keys(),k=0,l=j.length;l>k&&b(j[k]);++k);d.size()&&c()}return h}function e(a,b,c){var d=a.node(c).rank-a.node(b).rank,e=h.max(a.outEdges(b,c).map(function(b){return a.edge(b).minLen}));return d-e}var f=a("cp-data").Set,g=a("graphlib").Digraph,h=a("../util");b.exports=d},{"../util":17,"cp-data":19,graphlib:24}],14:[function(a,b,c){function d(a){var b=f(a);b.forEach(function(b){var c=a.inEdges(b);if(0===c.length)return void(a.node(b).rank=0);var d=c.map(function(b){return a.node(a.source(b)).rank+a.edge(b).minLen});a.node(b).rank=e.max(d)})}var e=a("../util"),f=a("graphlib").alg.topsort;b.exports=d},{"../util":17,graphlib:24}],15:[function(a,b,c){function d(a,b,c,d){return Math.abs(a.node(b).rank-a.node(c).rank)-d}b.exports={slack:d}},{}],16:[function(a,b,c){function d(a,b){for(e(a,b);;){var c=i(b);if(null===c)break;var d=j(a,b,c);k(a,b,c,d)}}function e(a,b){function c(d){var e=b.successors(d);for(var f in e){var h=e[f];c(h)}d!==b.graph().root&&g(a,b,d)}f(b),b.eachEdge(function(a,b,c,d){d.cutValue=0}),c(b.graph().root)}function f(a){function b(d){var e=a.successors(d),f=c;for(var g in e){var h=e[g];b(h),f=Math.min(f,a.node(h).low)}a.node(d).low=f,a.node(d).lim=c++}var c=0;b(a.graph().root)}function g(a,b,c){var d=b.inEdges(c)[0],e=[],f=b.outEdges(c);for(var g in f)e.push(b.target(f[g]));var i,j=0,k=0,l=0,m=0,n=0,o=a.outEdges(c);for(var p in o){var q=a.target(o[p]);for(i in e)h(b,q,e[i])&&k++;h(b,q,c)||m++}var r=a.inEdges(c);for(var s in r){var t=a.source(r[s]);for(i in e)h(b,t,e[i])&&l++;h(b,t,c)||n++}var u=0;for(i in e){var v=b.edge(f[i]).cutValue;b.edge(f[i]).reversed?u-=v:u+=v}b.edge(d).reversed?j-=u-k+l-m+n:j+=u-k+l-m+n,b.edge(d).cutValue=j}function h(a,b,c){return a.node(c).low<=a.node(b).lim&&a.node(b).lim<=a.node(c).lim}function i(a){var b=a.edges();for(var c in b){var d=b[c],e=a.edge(d);if(e.cutValue<0)return d}return null}function j(a,b,c){var d,e=b.source(c),f=b.target(c),g=b.node(f).lim<b.node(e).lim?f:e,i=!b.edge(c).reversed,j=Number.POSITIVE_INFINITY;if(a.eachEdge(i?function(e,f,i,k){if(e!==c&&h(b,f,g)&&!h(b,i,g)){var l=o.slack(a,f,i,k.minLen);j>l&&(j=l,d=e)}}:function(e,f,i,k){if(e!==c&&!h(b,f,g)&&h(b,i,g)){var l=o.slack(a,f,i,k.minLen);j>l&&(j=l,d=e)}}),void 0===d){var k=[],l=[];throw a.eachNode(function(a){h(b,a,g)?l.push(a):k.push(a)}),new Error("No edge found from outside of tree to inside")}return d}function k(a,b,c,d){function f(a){var c=b.inEdges(a);for(var d in c){var e=c[d],g=b.source(e),h=b.edge(e);f(g),b.delEdge(e),h.reversed=!h.reversed,b.addEdge(e,a,g,h)}}b.delEdge(c);var g=a.source(d),h=a.target(d);f(h);for(var i=g,j=b.inEdges(i);j.length>0;)i=b.source(j[0]),j=b.inEdges(i);b.graph().root=i,b.addEdge(null,g,h,{cutValue:0}),e(a,b),l(a,b)}function l(a,b){function c(d){var e=b.successors(d);e.forEach(function(b){var e=m(a,d,b);a.node(b).rank=a.node(d).rank+e,c(b)})}c(b.graph().root)}function m(a,b,c){var d=a.outEdges(b,c);if(d.length>0)return n.max(d.map(function(b){return a.edge(b).minLen}));var e=a.inEdges(b,c);return e.length>0?-n.max(e.map(function(b){return a.edge(b).minLen})):void 0}var n=a("../util"),o=a("./rankUtil");b.exports=d},{"../util":17,"./rankUtil":15}],17:[function(a,b,c){function d(a,b){return function(){var c=(new Date).getTime();try{return b.apply(null,arguments)}finally{e(1,a+" time: "+((new Date).getTime()-c)+"ms")}}}function e(a){e.level>=a&&console.log.apply(console,Array.prototype.slice.call(arguments,1))}c.min=function(a){return Math.min.apply(Math,a)},c.max=function(a){return Math.max.apply(Math,a)},c.all=function(a,b){for(var c=0;c<a.length;++c)if(!b(a[c]))return!1;return!0},c.sum=function(a){return a.reduce(function(a,b){return a+b},0)},c.values=function(a){return Object.keys(a).map(function(b){return a[b]})},c.shuffle=function(a){for(i=a.length-1;i>0;--i){var b=Math.floor(Math.random()*(i+1)),c=a[b];a[b]=a[i],a[i]=c}},c.propertyAccessor=function(a,b,c,d){return function(e){return arguments.length?(b[c]=e,d&&d(e),a):b[c]}},c.ordering=function(a){var b=[];return a.eachNode(function(a,c){var d=b[c.rank]||(b[c.rank]=[]);d[c.order]=a}),b},c.filterNonSubgraphs=function(a){return function(b){return 0===a.children(b).length}},d.enabled=!1,c.time=d,e.level=0,c.log=e},{}],18:[function(a,b,c){b.exports="0.4.5"},{}],19:[function(a,b,c){c.Set=a("./lib/Set"),c.PriorityQueue=a("./lib/PriorityQueue"),c.version=a("./lib/version")},{"./lib/PriorityQueue":20,"./lib/Set":21,"./lib/version":23}],20:[function(a,b,c){function d(){this._arr=[],this._keyIndices={}}b.exports=d,d.prototype.size=function(){return this._arr.length},d.prototype.keys=function(){return this._arr.map(function(a){return a.key})},d.prototype.has=function(a){return a in this._keyIndices},d.prototype.priority=function(a){var b=this._keyIndices[a];return void 0!==b?this._arr[b].priority:void 0},d.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},d.prototype.add=function(a,b){var c=this._keyIndices;if(!(a in c)){var d=this._arr,e=d.length;return c[a]=e,d.push({key:a,priority:b}),this._decrease(e),!0}return!1},d.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var a=this._arr.pop();return delete this._keyIndices[a.key],this._heapify(0),a.key},d.prototype.decrease=function(a,b){var c=this._keyIndices[a];if(b>this._arr[c].priority)throw new Error("New priority is greater than current priority. Key: "+a+" Old: "+this._arr[c].priority+" New: "+b);this._arr[c].priority=b,this._decrease(c)},d.prototype._heapify=function(a){var b=this._arr,c=2*a,d=c+1,e=a;c<b.length&&(e=b[c].priority<b[e].priority?c:e,d<b.length&&(e=b[d].priority<b[e].priority?d:e),e!==a&&(this._swap(a,e),this._heapify(e)))},d.prototype._decrease=function(a){for(var b,c=this._arr,d=c[a].priority;0!==a&&(b=a>>1,!(c[b].priority<d));)this._swap(a,b),a=b},d.prototype._swap=function(a,b){var c=this._arr,d=this._keyIndices,e=c[a],f=c[b];c[a]=f,c[b]=e,d[f.key]=a,d[e.key]=b}},{}],21:[function(a,b,c){function d(a){if(this._size=0,this._keys={},a)for(var b=0,c=a.length;c>b;++b)this.add(a[b])}function e(a){var b,c=Object.keys(a),d=c.length,e=new Array(d);for(b=0;d>b;++b)e[b]=a[c[b]];return e}var f=a("./util");b.exports=d,d.intersect=function(a){if(0===a.length)return new d;for(var b=new d(f.isArray(a[0])?a[0]:a[0].keys()),c=1,e=a.length;e>c;++c)for(var g=b.keys(),h=f.isArray(a[c])?new d(a[c]):a[c],i=0,j=g.length;j>i;++i){var k=g[i];h.has(k)||b.remove(k)}return b},d.union=function(a){for(var b=f.reduce(a,function(a,b){return a+(b.size?b.size():b.length)},0),c=new Array(b),e=0,g=0,h=a.length;h>g;++g)for(var i=a[g],j=f.isArray(i)?i:i.keys(),k=0,l=j.length;l>k;++k)c[e++]=j[k];return new d(c)},d.prototype.size=function(){return this._size},d.prototype.keys=function(){return e(this._keys)},d.prototype.has=function(a){return a in this._keys},d.prototype.add=function(a){return a in this._keys?!1:(this._keys[a]=a,++this._size,!0)},d.prototype.remove=function(a){return a in this._keys?(delete this._keys[a],--this._size,!0):!1}},{"./util":22}],22:[function(a,b,c){Array.isArray?c.isArray=Array.isArray:c.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)},"function"!=typeof Array.prototype.reduce?c.reduce=function(a,b,c){"use strict";if(null===a||"undefined"==typeof a)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof b)throw new TypeError(b+" is not a function");var d,e,f=a.length>>>0,g=!1;for(1<arguments.length&&(e=c,g=!0),d=0;f>d;++d)a.hasOwnProperty(d)&&(g?e=b(e,a[d],d,a):(e=a[d],g=!0));if(!g)throw new TypeError("Reduce of empty array with no initial value");return e}:c.reduce=function(a,b,c){return a.reduce(b,c)}},{}],23:[function(a,b,c){b.exports="1.1.3"},{}],24:[function(a,b,c){c.Graph=a("./lib/Graph"),c.Digraph=a("./lib/Digraph"),c.CGraph=a("./lib/CGraph"),c.CDigraph=a("./lib/CDigraph"),a("./lib/graph-converters"),c.alg={isAcyclic:a("./lib/alg/isAcyclic"),components:a("./lib/alg/components"),dijkstra:a("./lib/alg/dijkstra"),dijkstraAll:a("./lib/alg/dijkstraAll"),findCycles:a("./lib/alg/findCycles"),floydWarshall:a("./lib/alg/floydWarshall"),postorder:a("./lib/alg/postorder"),preorder:a("./lib/alg/preorder"),prim:a("./lib/alg/prim"),tarjan:a("./lib/alg/tarjan"),topsort:a("./lib/alg/topsort")},c.converter={json:a("./lib/converter/json.js")};var d=a("./lib/filter");c.filter={all:d.all,nodesFromList:d.nodesFromList},c.version=a("./lib/version")},{"./lib/CDigraph":26,"./lib/CGraph":27,"./lib/Digraph":28,"./lib/Graph":29,"./lib/alg/components":30,"./lib/alg/dijkstra":31,"./lib/alg/dijkstraAll":32,"./lib/alg/findCycles":33,"./lib/alg/floydWarshall":34,"./lib/alg/isAcyclic":35,"./lib/alg/postorder":36,"./lib/alg/preorder":37,"./lib/alg/prim":38,"./lib/alg/tarjan":39,"./lib/alg/topsort":40,"./lib/converter/json.js":42,"./lib/filter":43,"./lib/graph-converters":44,"./lib/version":46}],25:[function(a,b,c){function d(){this._value=void 0,this._nodes={},this._edges={},this._nextId=0}function e(a,b,c){(a[b]||(a[b]=new g)).add(c)}function f(a,b,c){var d=a[b];d.remove(c),0===d.size()&&delete a[b]}var g=a("cp-data").Set;b.exports=d,d.prototype.order=function(){return Object.keys(this._nodes).length},d.prototype.size=function(){return Object.keys(this._edges).length},d.prototype.graph=function(a){return 0===arguments.length?this._value:void(this._value=a)},d.prototype.hasNode=function(a){return a in this._nodes},d.prototype.node=function(a,b){var c=this._strictGetNode(a);return 1===arguments.length?c.value:void(c.value=b)},d.prototype.nodes=function(){var a=[];return this.eachNode(function(b){a.push(b)}),a},d.prototype.eachNode=function(a){for(var b in this._nodes){var c=this._nodes[b];a(c.id,c.value)}},d.prototype.hasEdge=function(a){return a in this._edges},d.prototype.edge=function(a,b){var c=this._strictGetEdge(a);return 1===arguments.length?c.value:void(c.value=b)},d.prototype.edges=function(){var a=[];return this.eachEdge(function(b){a.push(b)}),a},d.prototype.eachEdge=function(a){for(var b in this._edges){var c=this._edges[b];a(c.id,c.u,c.v,c.value)}},d.prototype.incidentNodes=function(a){var b=this._strictGetEdge(a);return[b.u,b.v]},d.prototype.addNode=function(a,b){if(void 0===a||null===a){do a="_"+ ++this._nextId;while(this.hasNode(a))}else if(this.hasNode(a))throw new Error("Graph already has node '"+a+"'");return this._nodes[a]={id:a,value:b},a},d.prototype.delNode=function(a){this._strictGetNode(a),this.incidentEdges(a).forEach(function(a){this.delEdge(a)},this),delete this._nodes[a]},d.prototype._addEdge=function(a,b,c,d,f,g){if(this._strictGetNode(b),this._strictGetNode(c),void 0===a||null===a){do a="_"+ ++this._nextId;while(this.hasEdge(a))}else if(this.hasEdge(a))throw new Error("Graph already has edge '"+a+"'");return this._edges[a]={id:a,u:b,v:c,value:d},e(f[c],b,a),e(g[b],c,a),a},d.prototype._delEdge=function(a,b,c){var d=this._strictGetEdge(a);f(b[d.v],d.u,a),f(c[d.u],d.v,a),delete this._edges[a]},d.prototype.copy=function(){var a=new this.constructor;return a.graph(this.graph()),this.eachNode(function(b,c){a.addNode(b,c)}),this.eachEdge(function(b,c,d,e){a.addEdge(b,c,d,e)}),a._nextId=this._nextId,a},d.prototype.filterNodes=function(a){var b=new this.constructor;return b.graph(this.graph()),this.eachNode(function(c,d){a(c)&&b.addNode(c,d)}),this.eachEdge(function(a,c,d,e){b.hasNode(c)&&b.hasNode(d)&&b.addEdge(a,c,d,e)}),b},d.prototype._strictGetNode=function(a){var b=this._nodes[a];if(void 0===b)throw new Error("Node '"+a+"' is not in graph");return b},d.prototype._strictGetEdge=function(a){var b=this._edges[a];if(void 0===b)throw new Error("Edge '"+a+"' is not in graph");return b}},{"cp-data":19}],26:[function(a,b,c){var d=a("./Digraph"),e=a("./compoundify"),f=e(d);b.exports=f,f.fromDigraph=function(a){var b=new f,c=a.graph();return void 0!==c&&b.graph(c),a.eachNode(function(a,c){void 0===c?b.addNode(a):b.addNode(a,c)}),a.eachEdge(function(a,c,d,e){void 0===e?b.addEdge(null,c,d):b.addEdge(null,c,d,e)}),b},f.prototype.toString=function(){return"CDigraph "+JSON.stringify(this,null,2)}},{"./Digraph":28,"./compoundify":41}],27:[function(a,b,c){var d=a("./Graph"),e=a("./compoundify"),f=e(d);b.exports=f,f.fromGraph=function(a){var b=new f,c=a.graph();return void 0!==c&&b.graph(c),a.eachNode(function(a,c){void 0===c?b.addNode(a):b.addNode(a,c)}),a.eachEdge(function(a,c,d,e){void 0===e?b.addEdge(null,c,d):b.addEdge(null,c,d,e)}),b},f.prototype.toString=function(){return"CGraph "+JSON.stringify(this,null,2)}},{"./Graph":29,"./compoundify":41}],28:[function(a,b,c){function d(){f.call(this),this._inEdges={},this._outEdges={}}var e=a("./util"),f=a("./BaseGraph"),g=a("cp-data").Set;b.exports=d,d.prototype=new f,d.prototype.constructor=d,d.prototype.isDirected=function(){return!0},d.prototype.successors=function(a){return this._strictGetNode(a),Object.keys(this._outEdges[a]).map(function(a){return this._nodes[a].id},this)},d.prototype.predecessors=function(a){return this._strictGetNode(a),Object.keys(this._inEdges[a]).map(function(a){return this._nodes[a].id},this)},d.prototype.neighbors=function(a){return g.union([this.successors(a),this.predecessors(a)]).keys()},d.prototype.sources=function(){var a=this;return this._filterNodes(function(b){return 0===a.inEdges(b).length})},d.prototype.sinks=function(){var a=this;return this._filterNodes(function(b){return 0===a.outEdges(b).length})},d.prototype.source=function(a){return this._strictGetEdge(a).u},d.prototype.target=function(a){return this._strictGetEdge(a).v},d.prototype.inEdges=function(a,b){this._strictGetNode(a);var c=g.union(e.values(this._inEdges[a])).keys();return arguments.length>1&&(this._strictGetNode(b),c=c.filter(function(a){return this.source(a)===b},this)),c},d.prototype.outEdges=function(a,b){this._strictGetNode(a);var c=g.union(e.values(this._outEdges[a])).keys();return arguments.length>1&&(this._strictGetNode(b),c=c.filter(function(a){return this.target(a)===b},this)),c},d.prototype.incidentEdges=function(a,b){return arguments.length>1?g.union([this.outEdges(a,b),this.outEdges(b,a)]).keys():g.union([this.inEdges(a),this.outEdges(a)]).keys()},d.prototype.toString=function(){return"Digraph "+JSON.stringify(this,null,2)},d.prototype.addNode=function(a,b){return a=f.prototype.addNode.call(this,a,b),this._inEdges[a]={},this._outEdges[a]={},a},d.prototype.delNode=function(a){f.prototype.delNode.call(this,a),delete this._inEdges[a],delete this._outEdges[a]},d.prototype.addEdge=function(a,b,c,d){return f.prototype._addEdge.call(this,a,b,c,d,this._inEdges,this._outEdges)},d.prototype.delEdge=function(a){f.prototype._delEdge.call(this,a,this._inEdges,this._outEdges)},d.prototype._filterNodes=function(a){var b=[];return this.eachNode(function(c){a(c)&&b.push(c)}),b}},{"./BaseGraph":25,"./util":45,"cp-data":19}],29:[function(a,b,c){function d(){f.call(this),this._incidentEdges={}}var e=a("./util"),f=a("./BaseGraph"),g=a("cp-data").Set;b.exports=d,d.prototype=new f,d.prototype.constructor=d,d.prototype.isDirected=function(){return!1},d.prototype.neighbors=function(a){return this._strictGetNode(a),Object.keys(this._incidentEdges[a]).map(function(a){return this._nodes[a].id},this)},d.prototype.incidentEdges=function(a,b){return this._strictGetNode(a),
arguments.length>1?(this._strictGetNode(b),b in this._incidentEdges[a]?this._incidentEdges[a][b].keys():[]):g.union(e.values(this._incidentEdges[a])).keys()},d.prototype.toString=function(){return"Graph "+JSON.stringify(this,null,2)},d.prototype.addNode=function(a,b){return a=f.prototype.addNode.call(this,a,b),this._incidentEdges[a]={},a},d.prototype.delNode=function(a){f.prototype.delNode.call(this,a),delete this._incidentEdges[a]},d.prototype.addEdge=function(a,b,c,d){return f.prototype._addEdge.call(this,a,b,c,d,this._incidentEdges,this._incidentEdges)},d.prototype.delEdge=function(a){f.prototype._delEdge.call(this,a,this._incidentEdges,this._incidentEdges)}},{"./BaseGraph":25,"./util":45,"cp-data":19}],30:[function(a,b,c){function d(a){function b(c,e){d.has(c)||(d.add(c),e.push(c),a.neighbors(c).forEach(function(a){b(a,e)}))}var c=[],d=new e;return a.nodes().forEach(function(a){var d=[];b(a,d),d.length>0&&c.push(d)}),c}var e=a("cp-data").Set;b.exports=d},{"cp-data":19}],31:[function(a,b,c){function d(a,b,c,d){function f(b){var d=a.incidentNodes(b),e=d[0]!==i?d[0]:d[1],f=g[e],k=c(b),l=j.distance+k;if(0>k)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+b+" Weight: "+k);l<f.distance&&(f.distance=l,f.predecessor=i,h.decrease(e,l))}var g={},h=new e;c=c||function(){return 1},d=d||(a.isDirected()?function(b){return a.outEdges(b)}:function(b){return a.incidentEdges(b)}),a.eachNode(function(a){var c=a===b?0:Number.POSITIVE_INFINITY;g[a]={distance:c},h.add(a,c)});for(var i,j;h.size()>0&&(i=h.removeMin(),j=g[i],j.distance!==Number.POSITIVE_INFINITY);)d(i).forEach(f);return g}var e=a("cp-data").PriorityQueue;b.exports=d},{"cp-data":19}],32:[function(a,b,c){function d(a,b,c){var d={};return a.eachNode(function(f){d[f]=e(a,f,b,c)}),d}var e=a("./dijkstra");b.exports=d},{"./dijkstra":31}],33:[function(a,b,c){function d(a){return e(a).filter(function(a){return a.length>1})}var e=a("./tarjan");b.exports=d},{"./tarjan":39}],34:[function(a,b,c){function d(a,b,c){var d={},e=a.nodes();return b=b||function(){return 1},c=c||(a.isDirected()?function(b){return a.outEdges(b)}:function(b){return a.incidentEdges(b)}),e.forEach(function(f){d[f]={},d[f][f]={distance:0},e.forEach(function(a){f!==a&&(d[f][a]={distance:Number.POSITIVE_INFINITY})}),c(f).forEach(function(c){var e=a.incidentNodes(c),g=e[0]!==f?e[0]:e[1],h=b(c);h<d[f][g].distance&&(d[f][g]={distance:h,predecessor:f})})}),e.forEach(function(a){var b=d[a];e.forEach(function(c){var f=d[c];e.forEach(function(c){var d=f[a],e=b[c],g=f[c],h=d.distance+e.distance;h<g.distance&&(g.distance=h,g.predecessor=e.predecessor)})})}),d}b.exports=d},{}],35:[function(a,b,c){function d(a){try{e(a)}catch(b){if(b instanceof e.CycleException)return!1;throw b}return!0}var e=a("./topsort");b.exports=d},{"./topsort":40}],36:[function(a,b,c){function d(a,b,c){function d(b,e){if(f.has(b))throw new Error("The input graph is not a tree: "+a);f.add(b),a.neighbors(b).forEach(function(a){a!==e&&d(a,b)}),c(b)}var f=new e;if(a.isDirected())throw new Error("This function only works for undirected graphs");d(b)}var e=a("cp-data").Set;b.exports=d},{"cp-data":19}],37:[function(a,b,c){function d(a,b,c){function d(b,e){if(f.has(b))throw new Error("The input graph is not a tree: "+a);f.add(b),c(b),a.neighbors(b).forEach(function(a){a!==e&&d(a,b)})}var f=new e;if(a.isDirected())throw new Error("This function only works for undirected graphs");d(b)}var e=a("cp-data").Set;b.exports=d},{"cp-data":19}],38:[function(a,b,c){function d(a,b){function c(c){var e=a.incidentNodes(c),f=e[0]!==d?e[0]:e[1],g=i.priority(f);if(void 0!==g){var j=b(c);g>j&&(h[f]=d,i.decrease(f,j))}}var d,g=new e,h={},i=new f;if(0===a.order())return g;a.eachNode(function(a){i.add(a,Number.POSITIVE_INFINITY),g.addNode(a)}),i.decrease(a.nodes()[0],0);for(var j=!1;i.size()>0;){if(d=i.removeMin(),d in h)g.addEdge(null,d,h[d]);else{if(j)throw new Error("Input graph is not connected: "+a);j=!0}a.incidentEdges(d).forEach(c)}return g}var e=a("../Graph"),f=a("cp-data").PriorityQueue;b.exports=d},{"../Graph":29,"cp-data":19}],39:[function(a,b,c){function d(a){function b(g){var h=e[g]={onStack:!0,lowlink:c,index:c++};if(d.push(g),a.successors(g).forEach(function(a){a in e?e[a].onStack&&(h.lowlink=Math.min(h.lowlink,e[a].index)):(b(a),h.lowlink=Math.min(h.lowlink,e[a].lowlink))}),h.lowlink===h.index){var i,j=[];do i=d.pop(),e[i].onStack=!1,j.push(i);while(g!==i);f.push(j)}}if(!a.isDirected())throw new Error("tarjan can only be applied to a directed graph. Bad input: "+a);var c=0,d=[],e={},f=[];return a.nodes().forEach(function(a){a in e||b(a)}),f}b.exports=d},{}],40:[function(a,b,c){function d(a){function b(g){if(g in d)throw new e;g in c||(d[g]=!0,c[g]=!0,a.predecessors(g).forEach(function(a){b(a)}),delete d[g],f.push(g))}if(!a.isDirected())throw new Error("topsort can only be applied to a directed graph. Bad input: "+a);var c={},d={},f=[],g=a.sinks();if(0!==a.order()&&0===g.length)throw new e;return a.sinks().forEach(function(a){b(a)}),f}function e(){}b.exports=d,d.CycleException=e,e.prototype.toString=function(){return"Graph has at least one cycle"}},{}],41:[function(a,b,c){function d(a){function b(){a.call(this),this._parents={},this._children={},this._children[null]=new e}return b.prototype=new a,b.prototype.constructor=b,b.prototype.parent=function(a,b){if(this._strictGetNode(a),arguments.length<2)return this._parents[a];if(a===b)throw new Error("Cannot make "+a+" a parent of itself");null!==b&&this._strictGetNode(b),this._children[this._parents[a]].remove(a),this._parents[a]=b,this._children[b].add(a)},b.prototype.children=function(a){return null!==a&&this._strictGetNode(a),this._children[a].keys()},b.prototype.addNode=function(b,c){return b=a.prototype.addNode.call(this,b,c),this._parents[b]=null,this._children[b]=new e,this._children[null].add(b),b},b.prototype.delNode=function(b){var c=this.parent(b);return this._children[b].keys().forEach(function(a){this.parent(a,c)},this),this._children[c].remove(b),delete this._parents[b],delete this._children[b],a.prototype.delNode.call(this,b)},b.prototype.copy=function(){var b=a.prototype.copy.call(this);return this.nodes().forEach(function(a){b.parent(a,this.parent(a))},this),b},b.prototype.filterNodes=function(b){function c(a){var b=d.parent(a);return null===b||e.hasNode(b)?(f[a]=b,b):b in f?f[b]:c(b)}var d=this,e=a.prototype.filterNodes.call(this,b),f={};return e.eachNode(function(a){e.parent(a,c(a))}),e},b}var e=a("cp-data").Set;b.exports=d},{"cp-data":19}],42:[function(a,b,c){function d(a){return Object.prototype.toString.call(a).slice(8,-1)}var e=a("../Graph"),f=a("../Digraph"),g=a("../CGraph"),h=a("../CDigraph");c.decode=function(a,b,c){if(c=c||f,"Array"!==d(a))throw new Error("nodes is not an Array");if("Array"!==d(b))throw new Error("edges is not an Array");if("string"==typeof c)switch(c){case"graph":c=e;break;case"digraph":c=f;break;case"cgraph":c=g;break;case"cdigraph":c=h;break;default:throw new Error("Unrecognized graph type: "+c)}var i=new c;return a.forEach(function(a){i.addNode(a.id,a.value)}),i.parent&&a.forEach(function(a){a.children&&a.children.forEach(function(b){i.parent(b,a.id)})}),b.forEach(function(a){i.addEdge(a.id,a.u,a.v,a.value)}),i},c.encode=function(a){var b=[],c=[];a.eachNode(function(c,d){var e={id:c,value:d};if(a.children){var f=a.children(c);f.length&&(e.children=f)}b.push(e)}),a.eachEdge(function(a,b,d,e){c.push({id:a,u:b,v:d,value:e})});var d;if(a instanceof h)d="cdigraph";else if(a instanceof g)d="cgraph";else if(a instanceof f)d="digraph";else{if(!(a instanceof e))throw new Error("Couldn't determine type of graph: "+a);d="graph"}return{nodes:b,edges:c,type:d}}},{"../CDigraph":26,"../CGraph":27,"../Digraph":28,"../Graph":29}],43:[function(a,b,c){var d=a("cp-data").Set;c.all=function(){return function(){return!0}},c.nodesFromList=function(a){var b=new d(a);return function(a){return b.has(a)}}},{"cp-data":19}],44:[function(a,b,c){var d=a("./Graph"),e=a("./Digraph");d.prototype.toDigraph=d.prototype.asDirected=function(){var a=new e;return this.eachNode(function(b,c){a.addNode(b,c)}),this.eachEdge(function(b,c,d,e){a.addEdge(null,c,d,e),a.addEdge(null,d,c,e)}),a},e.prototype.toGraph=e.prototype.asUndirected=function(){var a=new d;return this.eachNode(function(b,c){a.addNode(b,c)}),this.eachEdge(function(b,c,d,e){a.addEdge(b,c,d,e)}),a}},{"./Digraph":28,"./Graph":29}],45:[function(a,b,c){c.values=function(a){var b,c=Object.keys(a),d=c.length,e=new Array(d);for(b=0;d>b;++b)e[b]=a[c[b]];return e}},{}],46:[function(a,b,c){b.exports="0.7.4"},{}]},{},[1]),"object"==typeof exports)var dagre=require("dagre");joint.layout.DirectedGraph={layout:function(a,b){b=b||{};var c=this._prepareData(a),d=dagre.layout();b.debugLevel&&d.debugLevel(b.debugLevel),b.rankDir&&d.rankDir(b.rankDir),b.rankSep&&d.rankSep(b.rankSep),b.edgeSep&&d.edgeSep(b.edgeSep),b.nodeSep&&d.nodeSep(b.nodeSep);var e=d.run(c);return e.eachNode(function(c,d){if(!d.dummy){var e=a.getCell(c);b.setPosition?b.setPosition(e,d):e.set("position",{x:d.x-d.width/2,y:d.y-d.height/2})}}),b.setLinkVertices&&e.eachEdge(function(c,d,e,f){var g=a.getCell(c);g&&(b.setVertices?b.setVertices(g,f.points):g.set("vertices",f.points))}),{width:e.graph().width,height:e.graph().height}},_prepareData:function(a){var b=new dagre.Digraph;return _.each(a.getElements(),function(a){b.hasNode(a.id)||b.addNode(a.id,{width:a.get("size").width,height:a.get("size").height,rank:a.get("rank")})}),_.each(a.getLinks(),function(a){if(!b.hasEdge(a.id)){var c=a.get("source").id,d=a.get("target").id;b.addEdge(a.id,c,d,{minLen:a.get("minLen")||1})}}),b}};