import { Meta, Story, Canvas, Controls, Markdown } from '@storybook/addon-docs/blocks';
import * as Stories from './story';

<Meta of={Stories} />

# Custom Element Controls

This example demonstrates how to add custom interactive controls to elements using JointJS's `elementTools.Control` class. Users can drag control handles directly on elements to dynamically adjust shape-specific properties.

## Overview

All 16 shapes are rendered as pure React SVG components inside `@joint/react`, each with a matching interactive control tool where applicable. This example shows how to:
- Render diagram shapes as React SVG components
- Create custom control classes extending `elementTools.Control`
- Position controls dynamically based on element geometry using `g.Line`, `g.Curve`, and `g.Point`
- Update element data properties through drag interactions, triggering React re-renders

## Demo

<Canvas of={Stories.Default} />

## Shapes

<table>
  <thead>
    <tr>
      <th>Shape</th>
      <th>Control</th>
      <th>Property</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>LinkedProcess</td><td>—</td><td>—</td></tr>
    <tr><td>Input</td><td>—</td><td>—</td></tr>
    <tr><td>Mark</td><td>—</td><td>—</td></tr>
    <tr><td>Actor</td><td>—</td><td>—</td></tr>
    <tr><td>Shipment</td><td>—</td><td>—</td></tr>
    <tr><td>Parallelogram</td><td><code>ParallelogramOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Hexagon</td><td><code>HexagonOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Step</td><td><code>StepOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Trapezoid</td><td><code>TrapezoidOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Document</td><td><code>DocumentOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Plus</td><td><code>PlusOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Arrow</td><td><code>ArrowOffsetControl</code></td><td><code>arrowHeight</code>, <code>thickness</code></td></tr>
    <tr><td>Note</td><td><code>NoteOffsetControl</code></td><td><code>offset</code></td></tr>
    <tr><td>Table</td><td><code>TableDividerControl</code></td><td><code>dividerX</code>, <code>dividerY</code></td></tr>
    <tr><td>Cube</td><td><code>CubeCornerControl</code></td><td><code>cornerX</code>, <code>cornerY</code></td></tr>
    <tr><td>Card</td><td><code>CardOffsetControl</code></td><td><code>offset</code></td></tr>
  </tbody>
</table>

## How It Works

1. **Custom Control Classes**: Each controllable shape has a corresponding `elementTools.Control` subclass
2. **Position Calculation**: `getPosition()` computes the control handle's position from current element properties using JointJS geometry utilities
3. **User Interaction**: When users drag a control handle, `setPosition()` receives the new coordinates and clamps them to valid ranges
4. **Property Updates**: Controls update element data via `model.prop('data/...')`, which triggers a React re-render of the shape component
