import { Meta, Story, Canvas, Controls, Markdown } from '@storybook/blocks';
import * as Stories from './story';
import CodeSVG from './code-svg?raw';
import CodeHTML from './code-html?raw';
import CodeHTMLRenderer from './code-html-renderer?raw';
import { getAPIDocumentationLink, getAPIPropsLink } from '../../utils/get-api-documentation-link'

<Meta of={Stories} />

# Basic Example

### How It Works

1. **Define default nodes (elements) and links (edges):**
   - You can create nodes and links using helper functions like {getAPIDocumentationLink("createElements")} and {getAPIDocumentationLink("createLinks")}. Alternatively, you can define them manually as arrays of `GraphElement | dia.Element` for nodes or `GraphLink | dia.Link` for links.
   - Example:
     ```ts
     const elements = createElements([
       { id: '1', color: 'blue', x: 100, y: 0, width: 100, height: 25 },
       { id: '2', color: 'blue', x: 100, y: 200, width: 100, height: 25 },
     ]);
     const links = createLinks([{ id: 'e1-2', source: '1', target: '2' }]);
     ```

2. **Wrap your app with {getAPIDocumentationLink('GraphProvider')}:**
   - The `GraphProvider` component wraps your app in a [jointjs/graph](https://docs.jointjs.com/api/dia/Graph) instance. It manages the React state for your nodes and links.
   - Example:
     ```tsx
     <GraphProvider initialElements={elements} initialLinks={links}>
       {/* Your components go here */}
     </GraphProvider>
     ```

3. **Render nodes with the {getAPIDocumentationLink('Paper', 'variables')} component:**
   - The `Paper` component is a wrapper around [jointjs/paper](https://docs.jointjs.com/learn/quickstart/paper/). It handles rendering your nodes.
   - The `Paper` component has a key prop called {getAPIPropsLink('Paper', 'renderElement')}, which defines how each node is rendered. It also accepts any `dia.paper.Options` and standard HTML attributes.
   - Example:
     ```tsx
     function RenderItem({ width, height, color }) {
       return <rect width={width} height={height} fill={color} />;
     }

     <Paper width="100%" renderElement={RenderItem} />
     ```

4. **Create a `RenderElement` function to render an SVG rectangle:**
   - Use the {getAPIPropsLink('Paper', 'renderElement')} function to define how each node should look. In this example, we render a rectangle (`rect`) SVG component.

### Using HTML Elements Inside SVG

- By default, this library works with SVG elements. To use HTML elements, you need to wrap them in a `foreignObject` element.
- The `foreignObject` element allows you to include HTML within an SVG. Keep in mind that its default `overflow` property is set to `hidden`, so you may need to adjust it.
- Reference: [MDN foreignObject](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/foreignObject)
- Example:
  ```tsx
  function RenderItem({ label, width, height }: CustomElement) {
    return (
      <foreignObject width={width} height={height}>
        <MeasuredNode>
          <div className="node">{label}</div>
        </MeasuredNode>
      </foreignObject>
    );
  }
  ```

### Demo with SVG Node
<Canvas of={Stories.SVG} />

### Code
<Markdown>
{`\`\`\`tsx
${CodeSVG}
\`\`\``}
</Markdown>

### Demo with HTML Node
<Canvas of={Stories.HTML} />

### Code
<Markdown>
{`\`\`\`tsx
${CodeHTML}
\`\`\``}
</Markdown>

## Demo with HTML Element Renderer Instead of SVG
<Canvas of={Stories.HTMLRenderer} />
<Markdown>
{`\`\`\`tsx
${CodeHTMLRenderer}
\`\`\``}
</Markdown>