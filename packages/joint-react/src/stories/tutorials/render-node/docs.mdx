import { Meta, Story, Canvas, Controls, Markdown } from '@storybook/blocks';
import * as Stories from './story';
import CodeSVG from './code-svg?raw';
import CodeHTML from './code-html?raw';

<Meta of={Stories} />

# Basic example

### How it works

1. **Define default elements (nodes) and default links (edges)**
   - You can define elements and links using helper functions like `createElements` and `createLinks`. Alternatively, you can define them manually as `Array<GraphElement | dia.Element>` or `Array<GraphLink | dia.Link>`.
   - Example:
     ```ts
     const elements = createElements([
       { id: '1', data: { color: 'cyan' }, x: 100, y: 0, width: 100, height: 25 },
       { id: '2', data: { color: 'magenta' }, x: 100, y: 200, width: 100, height: 25 },
     ]);
     const links = createLinks([{ id: 'e1-2', source: '1', target: '2' }]);
     ```

2. **Wrap your app inside `GraphProvider`**
   - The `GraphProvider` component wraps all its children within a [jointjs/graph](https://docs.jointjs.com/api/dia/Graph) instance and manages the React state for elements and links.
   - Example:
     ```tsx
     <GraphProvider defaultElements={elements} defaultLinks={links}>
       {/* Your components here */}
     </GraphProvider>
     ```

3. **Render nodes using the `Paper` component**
   - The `Paper` component is a wrapper around [jointjs/paper](https://docs.jointjs.com/learn/quickstart/paper/). It is responsible for rendering nodes.
   - The `Paper` component has an important prop called `renderElement`, which is responsible for rendering a node inside the paper. The `Paper` component accepts any `dia.paper.Options` and HTML attributes.
   - Example:
     ```tsx
     function RenderItem({ width, height, data: { color } }) {
       return <rect width={width} height={height} fill={color} />;
     }

     <Paper width={400} renderElement={RenderItem} />
     ```

4. **Create a `RenderElement` function and render an SVG rect component**
   - The `RenderElement` function defines how each node should be rendered. In this example, we render a rectangle (`rect`) SVG component.

### Using HTML elements inside SVG

- By default, this library works with SVG elements. If you want to use HTML elements, you need to use the `foreignObject` element.
- The `foreignObject` element allows for the inclusion of HTML within an SVG. Note that `foreignObject` has a default `overflow` property set to `hidden`, so you might need to adjust it.
- Reference: [MDN foreignObject](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/foreignObject)
- Example:
  ```tsx
  function RenderItem({ width, height, data: { label } }) {
    return (
      <foreignObject style={{ overflow: 'unset' }} width={width} height={height}>
        <div className="node">{label}</div>
      </foreignObject>
    );
  }
  ```

### Demo with SVG node
<Canvas of={Stories.SVG} />

### Code
<Markdown>
{`\`\`\`tsx
${CodeSVG}
\`\`\``}
</Markdown>

### Demo with HTML node
<Canvas of={Stories.HTML} />

### Code
<Markdown>
{`\`\`\`tsx
${CodeHTML}
\`\`\``}
</Markdown>

